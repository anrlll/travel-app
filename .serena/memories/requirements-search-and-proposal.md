# TravelApp 要件定義 - 旅行プラン検索

**ステータス**: ✅ 確定
**最終更新**: 2025-10-12

---

## 概要

ユーザーが**作成済みの旅行プランを検索・フィルタリング・表示**する機能。複数の検索条件、表示形式、並び替えオプションを組み合わせて、目的の旅行プランを素早く見つけられるようにする。

---

## 主要機能

### 1. 検索機能

#### キーワード検索
- タイトル・目的地名で部分一致検索
- 大文字小文字を区別しない
- 複数キーワード対応（AND検索）

#### 日付範囲検索
- 出発日範囲、帰着日範囲、期間内に含まれる旅行プランを検索
- カレンダーピッカーで選択
- クイック選択ボタン（今月、来月、今年）

#### タグ・カテゴリ検索
- 家族旅行、出張、一人旅、友人との旅行、記念日旅行
- 複数タグのOR検索対応

#### ステータス検索
- 計画中、確定、進行中、完了、キャンセル

### 2. フィルタリング機能

複数条件の組み合わせ:
- 日付範囲 + ステータス
- 目的地 + 予算範囲
- タグ + 日付 + ステータス

### 3. 並び替え機能

- 作成日順（新しい順/古い順）⭐デフォルト
- 出発日順（近い順/遠い順）
- タイトル順（あいうえお順/ABC順）
- 更新日順（新しい順/古い順）

### 4. 表示形式

#### リスト形式
- 縦スクロールリスト
- タイトル、目的地、日程、日数、ステータス、予算、サムネイル表示

#### カード形式
- グリッドレイアウト（サムネイル画像付き）
- レスポンシブ対応（デスクトップ3列、タブレット2列、モバイル1列）

#### 地図形式
- 目的地を地図上にマーカー表示
- ステータス別に色分け（🔴計画中、🟢確定、🔵完了、⚫キャンセル）
- マーカークリックで詳細表示

---

## データベース設計

### trip_plans（旅行プランテーブル）
- id, user_id, title, destination, start_date, end_date, status, total_budget, thumbnail_url, description
- インデックス: user_id, start_date, status, created_at

### tags（タグテーブル）
- id, name（家族旅行、出張、一人旅など）

### trip_plan_tags（旅行プランタグ関連テーブル）
- trip_plan_id, tag_id（多対多）

---

## API設計

**エンドポイント**: `GET /api/trip-plans/search`

**クエリパラメータ**:
- keyword, startDate, endDate, tags[], status[], budgetMin, budgetMax, sortBy, order, page, limit

**レスポンス**:
- tripPlans[]
- pagination{ total, page, limit, totalPages }

---

## パフォーマンス最適化

- ページネーション（10〜20件/ページ）
- 検索結果キャッシュ（5分間）
- サムネイル遅延読み込み
- データベースインデックス最適化

---

## アクセシビリティ

- キーボード操作対応
- スクリーンリーダー対応（ARIA）
- WCAG 2.1 Level AA準拠

---

## 関連ドキュメント

詳細は docs/requirements/01-search-and-proposal.md を参照