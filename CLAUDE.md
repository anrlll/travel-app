# Claude Code 実装ルール

## 概要
このドキュメントは、TravelAppプロジェクトにおけるClaude Codeの実装ルールとガイドラインを定義します。

## コミュニケーション原則

### 言語設定
- **回答言語**: Claude Codeは常に日本語で回答すること
- **コード内コメント**: 日本語でコメントを記述する
- **変数名・関数名**: 英語を使用（国際標準に準拠）
- **ドキュメント**: すべて日本語で作成する
- **エラーメッセージ**: ユーザー向けは日本語、ログは英語も可

## 基本原則

### 1. コード品質
- **可読性**: コードは明確で理解しやすいものにする
- **保守性**: 将来の変更に対応しやすい設計を心がける
- **再利用性**: 共通機能はモジュール化して再利用可能にする
- **テスタビリティ**: ユニットテストが書きやすい設計にする

### 2. 命名規則
- **変数名**: camelCaseを使用（例: `userName`, `travelDate`）
- **定数**: UPPER_SNAKE_CASEを使用（例: `MAX_DESTINATIONS`, `API_KEY`）
- **クラス名**: PascalCaseを使用（例: `TravelPlanner`, `UserService`）
- **ファイル名**: kebab-caseを使用（例: `travel-planner.ts`, `user-service.ts`）
- **意味のある名前**: 省略形は避け、目的が明確な名前を使用する

### 3. ディレクトリ構造
```
TravelApp/
├── src/
│   ├── components/     # UIコンポーネント
│   ├── services/       # ビジネスロジック・API呼び出し
│   ├── models/         # データモデル・型定義
│   ├── utils/          # ユーティリティ関数
│   ├── config/         # 設定ファイル
│   ├── hooks/          # カスタムフック（React等）
│   └── tests/          # テストファイル
├── public/             # 静的ファイル
├── docs/               # ドキュメント
└── scripts/            # ビルド・デプロイスクリプト
```

### 4. コメント・ドキュメント
- **関数・メソッド**: 複雑なロジックには説明コメントを追加
- **JSDoc形式**: 公開APIには型情報と説明を含むJSDocを記述
- **TODOコメント**: 未完成の実装には`// TODO: 説明`を追加
- **コードの意図**: 「何を」ではなく「なぜ」を説明する

### 5. エラーハンドリング
- **適切なエラーキャッチ**: try-catchブロックで例外を適切に処理
- **エラーメッセージ**: ユーザーにわかりやすいエラーメッセージを表示
- **ロギング**: エラー発生時には詳細をログに記録
- **フォールバック**: エラー時の代替動作を実装

### 6. セキュリティ
- **機密情報**: APIキーやパスワードは環境変数で管理
- **入力検証**: すべてのユーザー入力を検証・サニタイズ
- **認証・認可**: 適切なアクセス制御を実装
- **依存関係**: セキュリティ脆弱性のある依存パッケージを避ける

### 7. パフォーマンス
- **最適化**: 不要な再レンダリングや計算を避ける
- **遅延読み込み**: 大きなモジュールは必要時に読み込む
- **キャッシング**: 頻繁にアクセスするデータはキャッシュする
- **バンドルサイズ**: 不要な依存関係を削除してバンドルを最小化

### 8. バージョン管理
- **コミットメッセージ**: 変更内容を明確に記述
  - 形式: `<type>: <subject>`
  - 例: `feat: ユーザー認証機能を追加`, `fix: 日付表示のバグを修正`
- **ブランチ戦略**: feature/*, bugfix/*, hotfix/*などの接頭辞を使用
- **Pull Request**: コードレビューを必ず実施

### 9. テスト
- **ユニットテスト**: 個別の関数・コンポーネントをテスト
- **統合テスト**: 複数のモジュール間の連携をテスト
- **E2Eテスト**: ユーザーシナリオ全体をテスト
- **カバレッジ**: 最低80%のコードカバレッジを目指す

### 10. 国際化（i18n）
- **多言語対応**: UIテキストはハードコードせず、i18nライブラリを使用
- **日付・通貨**: ロケールに応じた適切なフォーマットを使用
- **翻訳ファイル**: 言語ごとに翻訳ファイルを分離

## 技術スタック（推奨）

### フロントエンド
- **フレームワーク**: React / Vue / Angular
- **状態管理**: Redux / Zustand / Pinia
- **スタイリング**: Tailwind CSS / styled-components
- **型安全**: TypeScript

### バックエンド
- **ランタイム**: Node.js / Deno
- **フレームワーク**: Express / Fastify / NestJS
- **データベース**: PostgreSQL / MongoDB
- **ORM**: Prisma / TypeORM

### 開発ツール
- **リンター**: ESLint
- **フォーマッター**: Prettier
- **テスト**: Jest / Vitest
- **ビルドツール**: Vite / Webpack

## コード例

### 良い例
```typescript
// ユーザー情報を取得する関数
async function fetchUserProfile(userId: string): Promise<UserProfile> {
  try {
    const response = await fetch(`/api/users/${userId}`);
    if (!response.ok) {
      throw new Error(`ユーザー情報の取得に失敗しました: ${response.status}`);
    }
    return await response.json();
  } catch (error) {
    console.error('ユーザー情報取得エラー:', error);
    throw error;
  }
}
```

### 避けるべき例
```typescript
// 悪い例: エラーハンドリングなし、型定義なし
async function getUser(id) {
  const r = await fetch('/api/users/' + id);
  return r.json();
}
```

## レビューチェックリスト
- [ ] コードは命名規則に従っているか
- [ ] 適切なエラーハンドリングが実装されているか
- [ ] セキュリティ上の問題はないか
- [ ] テストが書かれているか
- [ ] パフォーマンスへの影響は考慮されているか
- [ ] ドキュメント・コメントは適切か
- [ ] 既存のコードスタイルと一貫性があるか

## 更新履歴
- 2025-10-09: 初版作成
- 2025-10-09: コミュニケーション原則（日本語回答ルール）を追加
